{% extends "templates/partials/base.html" %}


{% block title %}{% parent %} - Projects{% endblock %}

{% block content %}

  {% set projects = cms.projects|sort('publish_date', true) %}

  <section id="projects-introduction" class="bg-light block half-strict crop">

      {% include "templates/partials/map.html" %}

  </section>


  <section id="projects" class="bg-white mb6" aside-enter>
  <div class="container-fluid">
  <div class="row">
      <div id="sidebar" class="col-sm-2">


       <aside class="hidden-xs">
          <ul>
            
            {% if ( cms.topics.length > 0 ) %}
            <li class="sidebar-item sidebar-topic-sort mb2">
              <ul>
                <li class="h5 uppercase bold sidebar-heading">Filter By Topic</li>
                <li class=""><hr class="hr-brand" /></li>
                <li data-sort-key=" " class="sort-key uppercase active sidebar-item mb2">All Projects</li>
                {% for topic in cms.topics %}

                  {% if topic.projects_relationship %}
                  <li data-sort-key="{{ topic.name|lower }}" class="sort-key sidebar-link uppercase mb1 {% if ( loop.index == cms.topics|size ) %}mb2{% endif %}">{{ topic.name }}</li>
                  {% endif %}
                {% endfor %}
              </ul>
            </li>
            {% endif %}

            {% if ( cms.regions.length > 0 ) %}
            <li class="sidebar-item sidebar-region-sort mb4">
              <ul>
                <li class="h5 uppercase bold sidebar-heading">Filter By Region</li>
                <li class=""><hr class="hr-brand" /></li>
                <li data-sort-key=" " class="sort-key uppercase active sidebar-item mb2">All Projects</li>
                {% for region in cms.regions %}
                  <li data-sort-key="{{ region.name|lower }}" class="sort-key sidebar-link uppercase mb1 {% if ( loop.index == cms.regions|size ) %}mb2{% endif %}">{{ region.name }}</li>
                {% endfor %}
              </ul>
            </li>
            {% endif %}

          </ul>

        </aside>

      </div>
      
      <div class="col-sm-9">
      <ul id="projects-list" class="">
        
        {% for project in projects %}

        {% if (loop.index0 % 2 == 0) %}
        <div class="row padded">
        {% endif %}

        <li id="project-{{ project.shortname|escape('url') }}" class="project-tint project-tile col-xs-offset-1 col-xs-10 col-sm-5 col-sm-offset-1 mb4-xs" data-publish-date="{{ project.publish_date }}" data-sort-value="{% for value in merge( project.topics, project.region ) %}{{ value.name|lower }} {% endfor %}"><a href="{{ url( project ) }}">
          <figure class=" mb2">
            <img class="project-tile-image" src="{{ project.images|first|imageCrop(500, 350) }}" />
          </figure>
          <h3 class="title project-tile-title">{{ project.name }}</h3>
          <p class="mb4 hidden-xs">{{ project.summary }}</p>
          <hr class="hr-light">
          {% if ( project.topics )%}
          <ul class="project-tile-topics">
            
            {% for topic in project.topics %}
              
              <li class="inline sidebar-link h6 uppercase">
              <a data-sort-key="{{topic.name|lower}}">
                {{ topic.name }}{% if ( loop.index < project.topics|size ) %}, {% endif %}
              </a>
              </li>

            {% endfor %}

          </ul>
          {% endif %}
       </a></li>

        {% if (loop.index0 % 2 == 1 || loop.index == projects|size ) %}
        </div>
        {% endif %}

        {% endfor %}
        </div>
      </ul>
      </div>
    </div>
    </div>
  </section>

  <section id="back" class="bg-white padded news-rule-xs" aside-exit>
    <div class="container">
    <div class="row">
      <div class="col-sm-offset-3 col-sm-6 centered">
        <a class="sync" href="/"><h5 class="back-to-home">
          Back To Home
        </h5></a>
      </div>
    </div>
    </div>
  </section>


{% endblock %}
